<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>🛰️RareFlow: Physics-Aware Flow-Matching for Cross-Sensor SR</title>
  <meta name="description" content="RareFlow: a physics-aware, dual-conditioned framework for cross-sensor super-resolution of rare Earth features with uncertainty gating." />
  <meta property="og:title" content="RareFlow: Physics-Aware Flow-Matching for Cross-Sensor SR" />
  <meta property="og:type" content="website" />
  <meta property="og:description" content="RareFlow balances geometric fidelity and semantic synthesis, enforces radiometric consistency, and reduces hallucinations under OOD shift." />
  <meta property="og:image" content="./assets/intro.png" />
  <link rel="icon" href="assets/favicon.svg" />
  <style>
    :root{
      --bg: #0b0c10; --panel:#0f1117; --ink:#e8e8ea; --muted:#b7b9c0;
      --brand:#8ee3ff; --brand2:#a5f3c7; --accent:#ffd166; --line:#1b1f2a;
      --radius:18px; --pad:18px; --max:1100px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.6 Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Apple Color Emoji,Segoe UI Emoji}
    a{color:var(--brand);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:var(--max);margin:auto;padding:24px}
    header.hero{display:grid;gap:18px;align-items:center;padding:36px 0}
    .badge{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border:1px solid var(--line);border-radius:999px;color:var(--muted);background:linear-gradient(180deg,#0f1220,#0b0d18)}
    h1{font-size:clamp(28px,4vw,48px);line-height:1.15;margin:0}
    .tag{font-size:18px;color:var(--muted);margin-top:4px}
    .authors{color:var(--muted)}
    .pill{display:inline-block;border:1px solid var(--line);padding:8px 12px;border-radius:999px;margin-right:8px;margin-top:8px}
    .btns{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
    .btn{
      display:inline-flex;align-items:center;gap:8px;
      padding:10px 14px;border-radius:12px;border:1px solid var(--line);
      background:linear-gradient(180deg,#11131e,#0e0f15); color:var(--ink)
    }
    .btn.primary{border-color:transparent;background:linear-gradient(90deg,var(--brand),var(--brand2));color:#0b0c10;font-weight:600}
    .grid{display:grid;gap:18px}
    @media(min-width:960px){ .grid.cols-2{grid-template-columns:1.1fr 0.9fr} .grid.cols-3{grid-template-columns:repeat(3,1fr)} }
    section.panel{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);padding:22px}
    section.panel h2{margin-top:0;margin-bottom:6px;font-size:24px}
    .muted{color:var(--muted)}
    figure{margin:0;border:1px solid var(--line);border-radius:16px;overflow:hidden;background:#0a0c13}
    figure img{display:block;width:100%;height:auto}
    figure figcaption{padding:10px 12px;color:var(--muted);font-size:14px;border-top:1px solid var(--line)}
    .kpis{display:grid;gap:12px;grid-template-columns:repeat(2,1fr)}
    @media(min-width:780px){ .kpis{grid-template-columns:repeat(4,1fr)} }
    .kpi{background:#0b0d14;border:1px solid var(--line);border-radius:14px;padding:14px}
    .kpi .val{font-size:22px;font-weight:700}
    code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .bib{white-space:pre-wrap;user-select:all; background:var(--panel);border:1px dashed var(--line);padding:14px;border-radius:12px;font-size:13px;font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;}
    footer{color:var(--muted);padding:28px 0}
    .callout{border:1px solid var(--line);background:linear-gradient(180deg,#101424,#0e111a);border-radius:16px;padding:16px}
    .small{font-size:14px}
    .chip{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;background:#0b0d14;border:1px solid var(--line);border-radius:999px;color:var(--muted);font-size:13px}

    /* Light theme variables */
    html[data-theme="light"]{
      --bg:#ffffff; --panel:#f8fafc; --ink:#0b0c10; --muted:#64748b;
      --brand:#8ee3ff; --brand2:#a5f3c7; --accent:#ffd166; --line:#e5e7eb;
    }

    /* Smooth theme transition */
    html, body { transition: background-color .25s ease, color .25s ease; }

    /* Component tweaks so they look nice in light mode */
    html[data-theme="light"] .badge{ background:linear-gradient(180deg,#ffffff,#f8fafc); }
    html[data-theme="light"] .btn{ background:linear-gradient(180deg,#ffffff,#f3f4f6); color:var(--ink); }
    html[data-theme="light"] figure{ background:#f1f5f9; }
    html[data-theme="light"] .kpi,
    html[data-theme="light"] .chip{ background:#ffffff; }
    html[data-theme="light"] .callout{ background:linear-gradient(180deg,#ffffff,#f6f7fb); }

    /* Floating theme toggle */
    .theme-toggle{
      position:fixed; right:18px; bottom:18px; z-index:1000;
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px; border-radius:999px;
      background:var(--panel); color:var(--ink);
      border:1px solid var(--line);
      box-shadow:0 6px 24px rgba(0,0,0,.18);
      cursor:pointer; user-select:none;
    }
    .theme-toggle .icon{ font-size:16px; line-height:1; }
    .theme-toggle .label{ font-size:14px; color:var(--muted); }
    .theme-toggle:focus-visible{ outline:2px solid var(--brand); outline-offset:2px; }

    /* ─────────────────────────────────────────────────────────────
       BEFORE/AFTER TEASER COMPARE SLIDER
       Drop in two images: LR (before) and SR (after). Accessible + no libs.
       ───────────────────────────────────────────────────────────── */
    .compare{ position:relative; border-radius:16px; overflow:hidden; border:1px solid var(--line); background:#0a0c13; }
    .compare img{ display:block; width:100%; height:auto; user-select:none; pointer-events:none; }
    .compare .after{ position:absolute; inset:0; clip-path: inset(0 0 0 calc(var(--pos, 50%))); }
    .compare input[type="range"]{
      position:absolute; inset:0; width:100%; height:100%; opacity:0; cursor:ew-resize; margin:0; z-index:3;
    }
    .compare .handle{ position:absolute; top:0; bottom:0; left:calc(var(--pos, 50%)); width:2px; background:var(--accent); transform:translateX(-1px); z-index:2; pointer-events:none; }
    .compare .handle::after{
      content:""; position:absolute; left:50%; top:50%; width:22px; height:22px; border-radius:50%; transform:translate(-50%,-50%);
      background:var(--panel); border:2px solid var(--line); box-shadow:0 6px 18px rgba(0,0,0,.35);
    }
    .compare .labels{ position:absolute; top:10px; left:10px; right:10px; display:flex; justify-content:space-between; gap:8px; z-index:1; }
    .compare .badge{ backdrop-filter: blur(6px); background: linear-gradient(180deg, rgba(16,18,28,.85), rgba(12,14,22,.85)); border-color:rgba(255,255,255,.12); }
    html[data-theme="light"] .compare .badge{ background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(245,247,252,.85)); }

    /* Method figure can be wide; ensure it doesn't shrink in a 2-col grid */
    .method-figure img{ width:100%; height:auto; display:block; }
      /* Quad teaser grid (4 separate images) */
    .quad{ display:grid; gap:12px; grid-template-columns:repeat(2,1fr); }
    .tile{ position:relative; border:1px solid var(--line); border-radius:16px; overflow:hidden; background:#0a0c13; }
    .tile img{ display:block; width:100%; height:auto; }
    .tile .badge{ position:absolute; top:10px; left:10px; backdrop-filter: blur(6px); background: linear-gradient(180deg, rgba(16,18,28,.85), rgba(12,14,22,.85)); border-color:rgba(255,255,255,.12); }
    html[data-theme="light"] .tile .badge{ background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(245,247,252,.85)); }

    @media (min-width: 960px){
  .cols-2-even{ grid-template-columns: repeat(2, 1fr); }
}
.span-all{ grid-column: 1 / -1; }
.abstract-narrow{ max-width: 72ch; margin-inline: auto; }

  </style>
</head>
<body>
  <div class="wrap">
    <header class="hero">
      <span class="badge">Under review • Cross-sensor Super-Resolution</span>
      <h1>RareFlow: Physics-Aware Flow-Matching for Cross-Sensor Super-Resolution of Rare-Earth Features</h1>
      <div class="tag">Balancing geometric fidelity and semantic synthesis under severe OOD shift.</div>
      <div class="authors">Forouzan Fallah · Wenwen Li · Chia-Yu Hsu · Hyunho Lee · Yezhou Yang — Arizona State University</div>
      <div class="btns">
        <a class="btn primary" href="#" aria-label="Open Paper PDF">📄 Paper (PDF)</a>
        <a class="btn" href="https://github.com/RareFlow/RareFlow" aria-label="Open Code Repository">👩‍💻 Code</a>
        <a class="btn" href="#bibtex" aria-label="Jump to BibTeX">🔖 BibTeX</a>
      </div>
    </header>

   <section class="panel grid cols-2-even" id="teaser">
  <!-- Row 1, Col 1: LR vs SR(LR) -->
  <figure class="compare" aria-label="Low-resolution input versus super-resolved (RareFlow)">
    <img src="assets/lr.png" alt="LR input"/>
    <img class="after" src="assets/sr_lr.png" alt="SR (RareFlow) from LR input"/>
    <div class="labels">
      <span class="badge" aria-hidden="true">LR</span>
      <span class="badge" aria-hidden="true">SR (RareFlow)</span>
    </div>
    <input type="range" min="0" max="100" value="50" aria-label="Reveal SR vs LR" />
    <div class="handle" aria-hidden="true"></div>
  </figure>

  <!-- Row 1, Col 2: HR↓ vs SR(HR) -->
  <figure class="compare" aria-label="HR downsampled to LR scale versus super-resolved (RareFlow)">
    <img src="assets/hr_d.png" alt="HR downsampled to LR scale (HR↓ → LR)"/>
    <img class="after" src="assets/sr_hr.png" alt="SR (RareFlow) from HR↓ reference"/>
    <div class="labels">
      <span class="badge" aria-hidden="true">HR ↓ (to LR)</span>
      <span class="badge" aria-hidden="true">SR (RareFlow)</span>
    </div>
    <input type="range" min="0" max="100" value="50" aria-label="Reveal SR vs HR↓" />
    <div class="handle" aria-hidden="true"></div>
  </figure>

<div id="abstract" class="abstract-narrow">
  <h2>Abstract</h2>
  <p>Super-resolution (SR) in remote sensing can look plausible yet be physically inaccurate, especially for rare geomorphic features and across sensors. <strong>RareFlow</strong> introduces a <em>dual-conditioning</em> architecture—a gated ControlNet to preserve fine-grained geometry from the LR input, plus <em>textual prompts</em> for semantic guidance—trained with a <em>physics-aware loss</em> that enforces spectral &amp; radiometric consistency. The framework also estimates uncertainty via <em>MC-dropout</em>, exposing unfamiliar inputs and mitigating hallucination. On a curated multi-sensor benchmark highlighting retrogressive thaw slumps (RTS), RareFlow attains strong perceptual gains (e.g., a ~38% lower FID than the next best) while maintaining fidelity, and experts often judged outputs on par with HR ground truth.</p>
  <div class="pill">Sentinel-2 → Maxar (10 m → 2 m)</div>
  <div class="pill">Physics-aware loss</div>
  <div class="pill">Uncertainty-gated ControlNet</div>
</div>

<!-- Row 2, Col 2: Photo + caption -->
<figure>
  <!-- swap the src below to your image, e.g. assets/abstract_side.png -->
  <img src="assets/intro.png"
       alt="Guidance ablation: spatial-only vs semantic-only vs RareFlow" />
  <figcaption>
    When the LR input is blurry or semantically OOD, spatial-only guidance preserves
    coarse morphology yet remains soft, while semantic-only guidance hallucinates
    plausible—but incorrect—textures. <em>RareFlow</em> balances structural evidence
    from the LR image with textual semantics, suppressing hallucinations and preserving
    physically consistent geometry and spectra.
  </figcaption>
</figure>
</section>


    <section class="panel" id="contribs">
      <h2>Key Contributions</h2>
      <ul>
        <li><strong>Dynamic control of priors:</strong> Gated ControlNet + text prompts, balancing geometry vs. semantics to reduce hallucinations under OOD shift.</li>
        <li><strong>Physics-aware objective:</strong> spectral magnitude alignment + blurred-CIELAB color consistency + LPIPS to preserve radiometry and discourage spurious detail.</li>
        <li><strong>Unified SR + harmonization:</strong> performs super-resolution and cross-sensor radiometric style transfer jointly.</li>
        <li><strong>SOTA under low data:</strong> ~800 labeled RTS images; improved perceptual metrics and expert validation.</li>
      </ul>
    </section>

    <!-- METHOD: split text and diagram so the (rectangular) image gets full width -->
    <section class="panel" id="method">
      <h2>Method Overview</h2>
      <p><strong>Dual-Conditioned Flow-Matching in Latent Space.</strong> A frozen VAE + diffusion transformer (SD3 MM-DiT) is steered by a trainable ControlNet that consumes LR latents and emits residual hints per block. Per-block scalar gates α<sub>l</sub>(t, u) depend on diffusion time and <em>uncertainty</em> u (from MC-dropout), scaling control strength during sampling.</p>
      <p><strong>Physics-Aware Loss.</strong> Base flow-matching loss + (i) <em>FFT magnitude</em> alignment (mid/high frequencies), (ii) <em>blurred-CIELAB</em> mean/std alignment for radiometry, and (iii) <em>LPIPS</em> for perceptual agreement.</p>
    </section>

    <section class="panel" id="method-figure">
      <figure class="method-figure">
        <img src="assets/method.png" alt="Control path produces residual hints and per-block gates injected into a frozen backbone."/>
        <figcaption>Figure 2 (p.4): Control path produces residual hints and per-block gates injected into a frozen backbone.</figcaption>
      </figure>
    </section>

    <section class="panel" id="results">
      <h2>Results Highlights</h2>
      <div class="kpis">
        <div class="kpi"><div class="val">116.16</div><div class="muted">FID (↓) — best; 38% lower vs AdcSR 187.18 (Table 1, p.7).</div></div>
        <div class="kpi"><div class="val">0.59</div><div class="muted">SSIM (↑) — best on paired LR–HR (Table 1, p.7).</div></div>
        <div class="kpi"><div class="val">0.83</div><div class="muted">FSIM (↑) — best (Table 1, p.7).</div></div>
        <div class="kpi"><div class="val">↓ LPIPS/DISTS</div><div class="muted">Both lowest on paired setting (Table 1, p.7).</div></div>
      </div>
      <figure style="margin-top:14px">
        <img src="assets/main_results.png" alt="Qualitative comparison strip across methods"/>
        <figcaption>Figure 4 (p.7): Cross-sensor SR + style transfer—RareFlow reconstructs geological detail and matches Maxar style; baselines retain Sentinel-2 style.</figcaption>
      </figure>
    </section>

    <section class="panel grid cols-2" id="dataset">
      <div>
        <h2>Dataset & Challenges</h2>
        <ul>
<p>
  These challenges include: 
  <strong>(1) Spatiotemporal misalignment</strong> between LR and HR images, acquired at different times, causes sub-pixel shifts, dramatic variations in illumination, and stark land cover changes. Furthermore, the dataset is characterized by <strong>(2) Small image dimensions</strong>, with inputs as small as 30×40 pixels, which prevent direct comparison to models evaluated on larger benchmark images. <strong>(3) A non-standard 12-bit data range</strong> that departs from the typical 8-bit format and makes model performance highly sensitive to the chosen normalization method as it materially alters input data distribution. <strong>(4) A limited training corpus of ≈ 800 images</strong>, which necessitates a data-efficient approach unsuitable for training large models from scratch.
</p>
        </ul>
      </div>
      <figure>
        <img src="assets/data_sample.png" alt="Data challenges: color normalization, spatial and temporal misalignment"/>
        <figcaption>Figure 3 (p.6): Radiometric shifts, spatial offsets, and snow cover differences between acquisitions.</figcaption>
      </figure>
    </section>

    <section class="panel" id="experts">
      <h2>Expert Evaluation</h2>
      <p>Geomorphology experts confirmed clear improvements over LR inputs; in many cases, super-resolved outputs were judged <em>perceptually on par</em> with 2 m Maxar ground truth for RTS features.</p>
    </section>

    <section class="panel" id="faq">
      <h2>FAQ</h2>
      <details>
        <summary>What keeps RareFlow from hallucinating?</summary>
        <div class="small">Uncertainty-gated control reduces prior “creativity” when evidence is weak; physics-aware losses constrain spectra & color.</div>
      </details>
      <details>
        <summary>Does it handle style differences between sensors?</summary>
        <div class="small">Yes—SR is coupled with explicit cross-sensor style transfer toward the target instrument’s radiometry and textures.</div>
      </details>
      <details>
        <summary>How should I write text prompts?</summary>
        <div class="small">
          Keep prompts <em>descriptive, not prescriptive</em>. Mention scene type, materials, and season (e.g., “periglacial terrain, exposed soil, early summer, minimal snow”). Avoid forcing tiny features (“sharp cracks everywhere”) which can induce artifacts. If the model seems too “creative”, shorten the prompt or lower guidance strength.
        </div>
      </details>
      <details>
        <summary>What controls the balance between geometry and synthesis?</summary>
        <div class="small">
          Two knobs: (1) <em>control strength / gating schedule</em>—higher gates anchor structure to the LR evidence; (2) <em>text guidance scale</em>—higher guidance adds semantics and style. For safety-first reconstructions, increase gates and reduce guidance.
        </div>
      </details>
      <details>
        <summary>What are the common failure modes?</summary>
        <div class="small">
          OOD textures (e.g., heavy snow, cloud, unusual materials), large temporal changes, and overly prescriptive prompts can cause oversharpening or incorrect semantics. Inspect uncertainty maps; if they spike, fall back to stronger control and lighter guidance.
        </div>
      </details>
      <details>
        <summary>Can I adapt this beyond satellite imagery?</summary>
        <div class="small">
          Yes—in principle to other cross-sensor SR tasks. For regulated domains (medical, surveillance), ensure domain approval, anonymization, and strict validation before deployment.
        </div>
      </details>
      <details>
        <summary>Any ethical or licensing considerations?</summary>
        <div class="small">
          Respect the licensing of commercial HR imagery and avoid using SR outputs to make unverifiable claims about fine-scale features. Clearly label synthesized content and provide LR inputs alongside results for context.
        </div>
      </details>
    </section>

    <section class="panel" id="bibtex">
      <h2>Cite</h2>
      <div class="bib">@inproceedings{RareFlow2026,
  title     = {RareFlow: Physics-Aware Flow-Matching for Cross-Sensor Super-Resolution of Rare-Earth Features},
  author    = {Fallah, Forouzan and Li, Wenwen and Hsu, Chia-Yu and Lee, Hyunho and Yang, Yezhou},
  booktitle = {Under Review},
  year      = {2026},
  note      = {Project page: rareflow.github.io}
}</div>
    </section>

    <footer class="wrap">
      <div class="small">© <span id="y"></span> RareFlow Authors.</div>
    </footer>
  </div>

  <button id="themeToggle" class="theme-toggle" type="button" aria-pressed="true" aria-label="Switch to light mode">
    <span class="icon" aria-hidden="true">🌙</span>
    <span class="label">Dark</span>
  </button>

  <script>
  (function () {
    const THEME_KEY = 'rareflow-theme';
    const root = document.documentElement;
    const prefersLight = window.matchMedia('(prefers-color-scheme: light)');

    function init() {
      // Footer year
      const yEl = document.getElementById('y');
      if (yEl) yEl.textContent = new Date().getFullYear();

      const btn = document.getElementById('themeToggle');
      if (!btn) return; // Button not present; nothing to do.

      const icon = btn.querySelector('.icon');
      const label = btn.querySelector('.label');

      const stored = localStorage.getItem(THEME_KEY);
      let theme = stored || (prefersLight.matches ? 'light' : 'dark');

      function apply() {
        if (theme === 'light') {
          root.setAttribute('data-theme', 'light');
          if (icon) icon.textContent = '☀️';
          if (label) label.textContent = 'Light';
          btn.setAttribute('aria-label', 'Switch to dark mode');
          btn.setAttribute('aria-pressed', 'false');
        } else {
          root.removeAttribute('data-theme'); // default = dark
          if (icon) icon.textContent = '🌙';
          if (label) label.textContent = 'Dark';
          btn.setAttribute('aria-label', 'Switch to light mode');
          btn.setAttribute('aria-pressed', 'true');
        }
      }

      apply();

      // Persist ONLY after the user explicitly toggles.
      btn.addEventListener('click', function () {
        theme = (theme === 'light') ? 'dark' : 'light';
        localStorage.setItem(THEME_KEY, theme);
        apply();
      });

      // Follow system changes only if user hasn't chosen a theme yet.
      if (!stored) {
        const mqHandler = (e) => { theme = e.matches ? 'light' : 'dark'; apply(); };
        if (prefersLight.addEventListener) {
          prefersLight.addEventListener('change', mqHandler);
        } else if (prefersLight.addListener) { // legacy Safari
          prefersLight.addListener(mqHandler);
        }
      }

      // ── Initialize teaser compare sliders (supports multiple) ─────────────
      document.querySelectorAll('.compare').forEach((compare) => {
        const range = compare.querySelector('input[type="range"]');
        const setPos = (p) => {
          const pct = Math.min(100, Math.max(0, +p));
          compare.style.setProperty('--pos', pct + '%');
          range.setAttribute('aria-valuenow', pct);
        };
        range.addEventListener('input', (e) => setPos(e.target.value));
        range.addEventListener('keydown', (e) => {
          if (e.key === 'Home') { setPos(0); }
          if (e.key === 'End')  { setPos(100); }
        });
        setPos(range.value || 50);
      });
    }

    // Ensure the DOM (including the button) exists first.
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init, { once: true });
    } else {
      init();
    }
  })();
  </script>
</body>
</html>
